{{ $page := .page }}
{{ $p := .project }}
{{ $b := .block }}
{{ $i := (or .scope_index 0) }}

{{ if not $p }}{{ $p = dict }}{{ end }}

{{ $scope := printf "zf-scope-footer-%d" $i }}

{{ partial "design_system/block_scope_vars.html" (dict
  "block_name" "footer"
  "block_variant" (or $b.block_variant "footer_default")
  "applies_to" "all"
  "scope_class" $scope
) }}

{{/* DATA */}}

{{/* brand: json project_name -> page.Title -> default */}}
{{ $brand := "" }}
{{ if and (isset $p "project_name") $p.project_name }}{{ $brand = $p.project_name }}{{ end }}
{{ if and (eq $brand "") (ne $page.Title "") }}{{ $brand = $page.Title }}{{ end }}
{{ if eq $brand "" }}{{ $brand = "Zack AI Project" }}{{ end }}

{{/* subtitle like on screen: footer_subtitle -> project_info_title -> default */}}
{{ $subtitle := "" }}
{{ with $page.Params.footer_subtitle }}{{ $subtitle = . }}{{ end }}
{{ if and (eq $subtitle "") (isset $p "footer_subtitle") }}{{ $subtitle = $p.footer_subtitle }}{{ end }}
{{ if and (eq $subtitle "") (ne $page.Params.project_info_title "") }}{{ $subtitle = $page.Params.project_info_title }}{{ end }}
{{ if and (eq $subtitle "") (isset $p "project_info_title") }}{{ $subtitle = $p.project_info_title }}{{ end }}
{{ if eq $subtitle "" }}{{ $subtitle = "Luxury apartments in the heart of Dubai" }}{{ end }}

{{ $powered := "" }}
{{ with $page.Params.footer_powered_text }}{{ $powered = . }}{{ end }}
{{ if and (eq $powered "") (isset $p "footer_powered_text") }}{{ $powered = $p.footer_powered_text }}{{ end }}
{{ if eq $powered "" }}{{ $powered = "Powered by Zack AI" }}{{ end }}

{{ $phone := "" }}
{{ with $page.Params.footer_phone }}{{ $phone = . }}{{ end }}
{{ if and (eq $phone "") (isset $p "footer_phone") }}{{ $phone = $p.footer_phone }}{{ end }}
{{ if eq $phone "" }}{{ $phone = "+7 999 999 99 99" }}{{ end }}

{{/* build tel safely: keep + and digits only */}}
{{ $tel := replace $phone " " "" }}
{{ $tel = replace $tel "(" "" }}
{{ $tel = replace $tel ")" "" }}
{{ $tel = replace $tel "-" "" }}

{{ $cta := "" }}
{{ with $page.Params.footer_cta_text }}{{ $cta = . }}{{ end }}
{{ if and (eq $cta "") (isset $p "footer_cta_text") }}{{ $cta = $p.footer_cta_text }}{{ end }}
{{ if eq $cta "" }}{{ $cta = "Contact us" }}{{ end }}

<footer class="zf-footer {{ $scope }}" id="contacts">
  <div class="zf-footer__inner">
    <div class="zf-footer__grid">

      <div class="zf-footer__left">
        <div class="zf-footer__brand">{{ $brand }}</div>
        <div class="zf-footer__subtitle">{{ $subtitle }}</div>
        <div class="zf-footer__powered">{{ $powered }}</div>
      </div>

      <div class="zf-footer__right">
        <div class="zf-footer__actions">
          <a class="zf-footer__pill" href="tel:{{ $tel }}">
            <span class="zf-footer__pill-icon" aria-hidden="true">â˜Ž</span>
            <span class="zf-footer__pill-text">{{ $phone }}</span>
          </a>

          <a class="zf-footer__pill" href="#contact">
            <span class="zf-footer__pill-text">{{ $cta }}</span>
          </a>
        </div>

        <nav class="zf-footer__nav" aria-label="Footer navigation">
          <a class="zf-footer__link" href="#amenities">Infrastructure</a>
          <a class="zf-footer__link" href="#units">Apartment</a>
          <a class="zf-footer__link" href="#gallery">Gallery</a>
          <a class="zf-footer__link" href="#contacts">Contacts</a>
        </nav>
      </div>

    </div>
  </div>
</footer>
